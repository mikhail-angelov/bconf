{"version":3,"sources":["components/robots/yaTranslator.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;IAIM;;;AAEF,aAFE,EAEF,CAAY,YAAZ,EAA0B,KAA1B,EAAiC;8BAF/B,IAE+B;;2EAF/B,eAGQ,cAAc,sBADS;;AAE7B,cAAK,IAAL,GAAY,mBAAZ,CAF6B;AAG7B,cAAK,KAAL,GAAa,KAAb,CAH6B;;AAK7B,cAAK,GAAL,GAAW,gDAAX,CAL6B;AAM7B,cAAK,GAAL,GAAW,gBAAO,MAAP,CAAc,cAAd,CANkB;;KAAjC;;iBAFE;;iCAWO,QAAQ,SAAS;;;AACtB,oBAAQ,GAAR,CAAY,SAAZ,EAAuB,OAAvB,EADsB;AAEtB,iBAAK,YAAL,GACK,IADL,CACU;uBAAI,OAAK,UAAL,CAAgB,QAAQ,OAAR,CAAgB,GAAhB;aAApB,CADV,CAEK,IAFL,CAEU;uBAAI,OAAK,aAAL,CAAmB,QAAQ,OAAR,CAAgB,GAAhB,EAAqB,OAAxC;aAAJ,CAFV,CAGK,IAHL,CAGU,sBAAa;AACf,wBAAQ,OAAR,CAAgB,GAAhB,GAAsB,WAAW,IAAX,CAAgB,CAAhB,CAAtB,CADe;AAEf,uBAAK,YAAL,CAAkB,IAAlB,CAAuB,MAAvB,EAA+B,OAA/B,EAFe;aAAb,CAHV,CAFsB;;;;uCAYX;AACX,gBAAI,MAAM,KAAK,GAAL,GACN,eADM,GACY,KAAK,GAAL,GAClB,MAFM,GAEG,IAFH,CADC;;AAKX,mBAAO,8BAAG,GAAH,EACF,IADE,CACG,UAAU,IAAV,EAAgB;AAClB,wBAAQ,GAAR,CAAY,SAAZ,EAAuB,IAAvB,EADkB;AAElB,uBAAO,IAAP,CAFkB;aAAhB,CADV,CALW;;;;mCAYJ,MAAM;AACb,gBAAI,MAAM,KAAK,GAAL,GACN,aADM,GACU,KAAK,GAAL,GAChB,UAFM,GAEO,IAFP,GAEc,IAFd,CADG;AAIb,mBAAO,8BAAG,GAAH,EACF,IADE,CACG,UAAU,IAAV,EAAgB;AAClB,wBAAQ,GAAR,CAAY,QAAZ,EAAsB,IAAtB,EADkB;AAElB,uBAAO,IAAP,CAFkB;aAAhB,CADV,CAJa;;;;sCAWH,MAAM,MAAM;AACtB,gBAAI,MAAM,KAAK,GAAL,GACN,gBADM,GACa,KAAK,GAAL,GACnB,UAFM,GAEO,IAFP,GAGN,UAHM,GAGO,IAHP,GAGc,EAHd,CADY;AAKtB,oBAAQ,GAAR,CAAY,WAAZ,EAAyB,GAAzB,EALsB;AAMtB,mBAAO,8BAAG,GAAH,EACF,IADE,CACG,UAAU,IAAV,EAAgB;AAClB,wBAAQ,GAAR,CAAY,WAAZ,EAAyB,IAAzB,EADkB;AAElB,uBAAO,KAAK,KAAL,CAAW,IAAX,CAAP,CAFkB;aAAhB,CADV,CANsB;;;;WA9CxB;;;kBA6DS","file":"components/robots/yaTranslator.js","sourcesContent":["import BaseBot from './baseBot.js'\nimport config from '../../config/environment/index';\nimport rp from 'request-promise';\n\nclass YT extends BaseBot {\n\n    constructor(RobotManager, $http) {\n        super(RobotManager, 'yandex-translator');\n        this.name = 'Yandex translator';\n        this.$http = $http;\n\n        this.url = 'https://translate.yandex.net/api/v1.5/tr.json/';\n        this.key = config.yandex.translationKey;\n    }\n\n    dispatch(client, message) {\n        console.log('message', message)\n        this.getLanguages()\n            .then(()=>this.detectText(message.payload.msg))\n            .then(()=>this.translateText(message.payload.msg, 'en-ru'))\n            .then(translated=> {\n                message.payload.msg = translated.text[0]\n                this.RobotManager.send(client, message);\n            });\n\n    }\n\n    getLanguages() {\n        let url = this.url +\n            'getLangs?key=' + this.key +\n            '&ui=' + 'en';\n\n        return rp(url)\n            .then(function (json) {\n                console.log('getlang', json)\n                return json;\n            });\n    }\n\n    detectText(text) {\n        let url = this.url +\n            'detect?key=' + this.key +\n            '&text=\\\"' + text + '\\\"';\n        return rp(url)\n            .then(function (json) {\n                console.log('detect', json)\n                return json;\n            });\n    }\n\n    translateText(text, lang) {\n        let url = this.url +\n            'translate?key=' + this.key +\n            '&text=\\\"' + text +\n            '\\\"&lang=' + lang + '';\n        console.log('translate', url)\n        return rp(url)\n            .then(function (json) {\n                console.log('translate', json)\n                return JSON.parse(json);\n            });\n    }\n\n}\n\nexport default YT;"],"sourceRoot":"/source/"}
{"version":3,"sources":["api/chat/chat.controller.js"],"names":[],"mappings":"AAAA;;;;;;;;;;;;AAMA,SAAS,eAAT,CAAyB,GAAzB,EAA8B,UAA9B,EAA0C;AACtC,iBAAa,cAAc,GAAd,CADyB;AAEtC,WAAO,UAAU,GAAV,EAAe;AAClB,YAAI,MAAJ,CAAW,UAAX,EAAuB,IAAvB,CAA4B,GAA5B,EADkB;KAAf,CAF+B;CAA1C;;AAOA,SAAS,cAAT,CAAwB,MAAxB,EAAgC;AAC5B,WAAO,eAAK,YAAL,CAAkB,EAAC,KAAK,MAAL,EAAnB,EAAiC,uBAAjC,CAAP,CAD4B;CAAhC;;AAIA,QAAQ,KAAR,GAAgB,UAAU,GAAV,EAAe,GAAf,EAAoB;AAChC,QAAI,SAAS,IAAI,IAAJ,CAAS,GAAT,CADmB;AAEhC,mBAAK,YAAL,CAAkB,MAAlB,EACK,IADL,CACU,iBAAS;AACH,YAAI,IAAJ,CAAS,KAAT,EADG;KAAT,CADV,CAFgC;CAApB;;AAShB,QAAQ,MAAR,GAAiB,UAAU,GAAV,EAAe,GAAf,EAAoB,IAApB,EAA0B;AACvC,QAAI,SAAS,IAAI,IAAJ,CAAS,GAAT,CAD0B;AAEvC,QAAI,OAAO,IAAI,IAAJ,CAF4B;AAGvC,mBAAK,MAAL,CAAY,MAAZ,EAAoB,IAApB,EACK,IADL,CACU,UAAU,OAAV,EAAmB;AACrB,YAAI,IAAJ,CAAS,OAAT,EADqB;KAAnB,CADV,CAIK,KAJL,CAIW,gBAAgB,GAAhB,CAJX,EAHuC;CAA1B;;AAUjB,QAAQ,MAAR,GAAiB,UAAU,GAAV,EAAe,GAAf,EAAoB;AACjC,QAAI,SAAS,IAAI,IAAJ,CAAS,GAAT,CADoB;AAEjC,QAAI,SAAS,IAAI,MAAJ,CAAW,MAAX,CAFoB;AAGjC,mBAAK,cAAL,CAAoB,MAApB,EAA2B,MAA3B,EACK,IADL,CACU,YAAY;AACd,YAAI,MAAJ,CAAW,GAAX,EAAgB,GAAhB,GADc;KAAZ,CADV,CAIK,KAJL,CAIW,gBAAgB,GAAhB,CAJX,EAHiC;CAApB;;AAWjB,QAAQ,UAAR,GAAqB,UAAU,GAAV,EAAe,GAAf,EAAoB;AACrC,QAAI,SAAS,IAAI,IAAJ,CAAS,GAAT,CADwB;AAErC,QAAI,SAAS,IAAI,MAAJ,CAAW,MAAX,CAFwB;AAGrC,QAAI,aAAa,IAAI,MAAJ,CAAW,MAAX,CAHoB;AAIrC,mBAAK,cAAL,CAAoB,MAApB,EAA2B,UAA3B,EACK,IADL,CACU,YAAY;AACd,YAAI,MAAJ,CAAW,GAAX,EAAgB,GAAhB,GADc;KAAZ,CADV,CAIK,KAJL,CAIW,gBAAgB,GAAhB,CAJX,EAJqC;CAApB;;AAWrB,QAAQ,OAAR,GAAkB,UAAU,GAAV,EAAe,GAAf,EAAoB;AAClC,QAAI,SAAS,IAAI,IAAJ,CAAS,GAAT,CADqB;AAElC,QAAI,SAAS,IAAI,MAAJ,CAAW,MAAX,CAFqB;AAGlC,QAAI,aAAa,IAAI,MAAJ,CAAW,MAAX,CAHiB;AAIlC,mBAAK,WAAL,CAAiB,MAAjB,EAAwB,UAAxB,EACK,IADL,CACU,YAAY;AACd,YAAI,MAAJ,CAAW,GAAX,EAAgB,GAAhB,GADc;KAAZ,CADV,CAIK,KAJL,CAIW,gBAAgB,GAAhB,CAJX,EAJkC;CAApB","file":"api/chat/chat.controller.js","sourcesContent":["'use strict';\n\nimport User from '../user/user.model';\nimport Chat from './chat.model';\n\n\nfunction validationError(res, statusCode) {\n    statusCode = statusCode || 422;\n    return function (err) {\n        res.status(statusCode).json(err);\n    }\n}\n\nfunction getCurrentUser(userId) {\n    return User.findOneAsync({_id: userId}, '-salt -hashedPassword');\n}\n\nexports.index = function (req, res) {\n    var userId = req.user._id;\n    Chat.getUserChats(userId)\n        .then(chats => {\n                    res.json(chats);\n        });\n};\n\n\nexports.create = function (req, res, next) {\n    var userId = req.user._id;\n    var chat = req.body;\n    Chat.create(userId, chat)\n        .then(function (newChat) {\n            res.json(newChat);\n        })\n        .catch(validationError(res));\n};\n\nexports.remove = function (req, res) {\n    var userId = req.user._id;\n    var chatId = req.params.chatId;\n    Chat.removeChatUser(chatId,userId)\n        .then(function () {\n            res.status(204).end();\n        })\n        .catch(validationError(res));\n};\n\n\nexports.removeUser = function (req, res) {\n    var userId = req.user._id;\n    var chatId = req.params.chatId;\n    var chatUserId = req.params.userId;\n    Chat.removeChatUser(chatId,chatUserId)\n        .then(function () {\n            res.status(204).end();\n        })\n        .catch(validationError(res));\n};\n\nexports.addUser = function (req, res) {\n    var userId = req.user._id;\n    var chatId = req.params.chatId;\n    var chatUserId = req.params.userId;\n    Chat.addChatUser(chatId,chatUserId)\n        .then(function () {\n            res.status(201).end();\n        })\n        .catch(validationError(res));\n};"],"sourceRoot":"/source/"}
{"version":3,"sources":["auth/local/index.js"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;AAOA,IAAI,SAAS,kBAAQ,MAAR,EAAT;;AAEJ,OAAO,IAAP,CAAY,GAAZ,EAAiB,UAAU,GAAV,EAAe,GAAf,EAAoB,IAApB,EAA0B;AACvC,uBAAS,YAAT,CAAsB,OAAtB,EAA+B,UAAU,GAAV,EAAe,IAAf,EAAqB,IAArB,EAA2B;AACtD,YAAI,QAAQ,OAAO,IAAP,CAD0C;AAEtD,YAAI,KAAJ,EAAW;AACP,mBAAO,IAAI,MAAJ,CAAW,GAAX,EAAgB,IAAhB,CAAqB,KAArB,CAAP,CADO;SAAX;AAGA,YAAI,CAAC,IAAD,EAAO;AACP,mBAAO,IAAI,MAAJ,CAAW,GAAX,EAAgB,IAAhB,CAAqB,EAAC,SAAS,yCAAT,EAAtB,CAAP,CADO;SAAX;;AAIA,YAAI,QAAQ,eAAK,SAAL,CAAe,KAAK,GAAL,EAAU,KAAK,IAAL,CAAjC,CATkD;AAUtD,YAAI,IAAJ,CAAS,EAAC,OAAO,KAAP,EAAV,EAVsD;KAA3B,CAA/B,CAWG,GAXH,EAWQ,GAXR,EAWa,IAXb,EADuC;CAA1B,CAAjB;;;AAgBA,OAAO,IAAP,CAAY,QAAZ,EAAsB,UAAU,GAAV,EAAe,GAAf,EAAoB,IAApB,EAA0B;;AAE5C,QAAI,UAAU,gBAAK,QAAL,EAAV,CAFwC;AAG5C,QAAI,QAAQ,eAAK,SAAL,CAAe,OAAf,EAAwB,OAAxB,CAAR,CAHwC;AAI5C,QAAI,IAAJ,CAAS,EAAC,OAAO,KAAP,EAAV,EAJ4C;CAA1B,CAAtB;;AAOA,OAAO,OAAP,GAAiB,MAAjB","file":"auth/local/index.js","sourcesContent":["'use strict';\n\nimport express from 'express';\nimport passport from 'passport';\nimport auth from '../auth.service';\nimport util from '../../components/util/index.js'\n\nvar router = express.Router();\n\nrouter.post('/', function (req, res, next) {\n    passport.authenticate('local', function (err, user, info) {\n        var error = err || info;\n        if (error) {\n            return res.status(401).json(error);\n        }\n        if (!user) {\n            return res.status(404).json({message: 'Something went wrong, please try again.'});\n        }\n\n        var token = auth.signToken(user._id, user.role);\n        res.json({token: token});\n    })(req, res, next)\n});\n\n//guest auth\nrouter.post('/guest', function (req, res, next) {\n    //todo: check capture\n    var guestId = util.randomId();\n    var token = auth.signToken(guestId, 'guest');\n    res.json({token: token});\n});\n\nmodule.exports = router;\n"],"sourceRoot":"/source/"}
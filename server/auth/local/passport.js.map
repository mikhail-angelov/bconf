{"version":3,"sources":["auth/local/passport.js"],"names":[],"mappings":";;;;;;;;;;AAGA,SAAS,iBAAT,CAA2B,IAA3B,EAAiC,KAAjC,EAAwC,QAAxC,EAAkD,IAAlD,EAAwD;AACtD,OAAK,YAAL,CAAkB;AAChB,WAAO,MAAM,WAAN,EAAP;GADF,EAGG,IAHH,CAGQ,UAAS,IAAT,EAAe;AACnB,QAAI,CAAC,IAAD,EAAO;AACT,aAAO,KAAK,IAAL,EAAW,KAAX,EAAkB;AACvB,iBAAS,+BAAT;OADK,CAAP,CADS;KAAX;AAKA,SAAK,YAAL,CAAkB,QAAlB,EAA4B,UAAS,SAAT,EAAoB,aAApB,EAAmC;AAC7D,UAAI,SAAJ,EAAe;AACb,eAAO,KAAK,SAAL,CAAP,CADa;OAAf;AAGA,UAAI,CAAC,aAAD,EAAgB;AAClB,eAAO,KAAK,IAAL,EAAW,KAAX,EAAkB;AACvB,mBAAS,+BAAT;SADK,CAAP,CADkB;OAApB,MAIO;AACL,eAAO,KAAK,IAAL,EAAW,IAAX,CAAP,CADK;OAJP;KAJ0B,CAA5B,CANmB;GAAf,CAHR,CAsBG,KAtBH,CAsBS,UAAS,GAAT,EAAc;;AAEnB,WAAO,KAAK,GAAL,CAAP,CAFmB;GAAd,CAtBT,CADsD;CAAxD;;AA6BA,QAAQ,KAAR,GAAgB,UAAS,IAAT,EAAe,MAAf,EAAuB;AACrC,qBAAS,GAAT,CAAa,4BAAkB;AAC7B,mBAAe,OAAf;AACA,mBAAe,UAAf;AAF6B,GAAlB,EAGV,UAAS,KAAT,EAAgB,QAAhB,EAA0B,IAA1B,EAAgC;AACjC,WAAO,kBAAkB,IAAlB,EAAwB,KAAxB,EAA+B,QAA/B,EAAyC,IAAzC,CAAP,CADiC;GAAhC,CAHH,EADqC;CAAvB","file":"auth/local/passport.js","sourcesContent":["import passport from 'passport';\nimport {Strategy as LocalStrategy} from 'passport-local';\n\nfunction localAuthenticate(User, email, password, done) {\n  User.findOneAsync({\n    email: email.toLowerCase()\n  })\n    .then(function(user) {\n      if (!user) {\n        return done(null, false, {\n          message: 'This email is not registered.'\n        });\n      }\n      user.authenticate(password, function(authError, authenticated) {\n        if (authError) {\n          return done(authError);\n        }\n        if (!authenticated) {\n          return done(null, false, {\n            message: 'This password is not correct.'\n          });\n        } else {\n          return done(null, user);\n        }\n      });\n    })\n    .catch(function(err) {\n\n      return done(err);\n    });\n}\n\nexports.setup = function(User, config) {\n  passport.use(new LocalStrategy({\n    usernameField: 'email',\n    passwordField: 'password' // this is the virtual field on the model\n  }, function(email, password, done) {\n    return localAuthenticate(User, email, password, done);\n  }));\n};\n"],"sourceRoot":"/source/"}
{"version":3,"sources":["auth/facebook/passport.js"],"names":[],"mappings":";;;;;;;;;;AAGA,QAAQ,KAAR,GAAgB,UAAS,IAAT,EAAe,MAAf,EAAuB;AACrC,qBAAS,GAAT,CAAa,+BAAqB;AAChC,cAAU,OAAO,QAAP,CAAgB,QAAhB;AACV,kBAAc,OAAO,QAAP,CAAgB,YAAhB;AACd,iBAAa,OAAO,QAAP,CAAgB,WAAhB;AACb,mBAAe,CACb,aADa,EAEb,QAFa,CAAf;GAJW,EASb,UAAS,WAAT,EAAsB,YAAtB,EAAoC,OAApC,EAA6C,IAA7C,EAAmD;AACjD,SAAK,YAAL,CAAkB;AAChB,qBAAe,QAAQ,EAAR;KADjB,EAGG,IAHH,CAGQ,UAAS,IAAT,EAAe;AACnB,UAAI,CAAC,IAAD,EAAO;AACT,eAAO,IAAI,IAAJ,CAAS;AACd,gBAAM,QAAQ,WAAR;AACN,iBAAO,QAAQ,MAAR,CAAe,CAAf,EAAkB,KAAlB,GAAwB,WAAxB;AACP,gBAAM,MAAN;AACA,oBAAU,UAAV;AACA,oBAAU,QAAQ,KAAR;SALL,CAAP,CADS;AAQT,aAAK,SAAL,GACG,IADH,CACQ,UAAS,IAAT,EAAe;AACnB,iBAAO,KAAK,IAAL,EAAW,IAAX,CAAP,CADmB;SAAf,CADR,CAIG,KAJH,CAIS,UAAS,GAAT,EAAc;AACnB,iBAAO,KAAK,GAAL,CAAP,CADmB;SAAd,CAJT,CARS;OAAX,MAeO;AACL,eAAO,KAAK,IAAL,EAAW,IAAX,CAAP,CADK;OAfP;KADI,CAHR,CAuBG,KAvBH,CAuBS,UAAS,GAAT,EAAc;AACnB,aAAO,KAAK,GAAL,CAAP,CADmB;KAAd,CAvBT,CADiD;GAAnD,CATA,EADqC;CAAvB","file":"auth/facebook/passport.js","sourcesContent":["import passport from 'passport';\nimport {Strategy as FacebookStrategy} from 'passport-facebook';\n\nexports.setup = function(User, config) {\n  passport.use(new FacebookStrategy({\n    clientID: config.facebook.clientID,\n    clientSecret: config.facebook.clientSecret,\n    callbackURL: config.facebook.callbackURL,\n    profileFields: [\n      'displayName',\n      'emails'\n    ]\n  },\n  function(accessToken, refreshToken, profile, done) {\n    User.findOneAsync({\n      'facebook.id': profile.id\n    })\n      .then(function(user) {\n        if (!user) {\n          user = new User({\n            name: profile.displayName,\n            email: profile.emails[0].value+'.facebook',\n            role: 'user',\n            provider: 'facebook',\n            facebook: profile._json\n          });\n          user.saveAsync()\n            .then(function(user) {\n              return done(null, user);\n            })\n            .catch(function(err) {\n              return done(err);\n            });\n        } else {\n          return done(null, user);\n        }\n      })\n      .catch(function(err) {\n        return done(err);\n      });\n  }));\n};\n"],"sourceRoot":"/source/"}
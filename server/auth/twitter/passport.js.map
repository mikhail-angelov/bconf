{"version":3,"sources":["auth/twitter/passport.js"],"names":[],"mappings":";;;;;;;;;;AAGA,QAAQ,KAAR,GAAgB,UAAS,IAAT,EAAe,MAAf,EAAuB;AACrC,qBAAS,GAAT,CAAa,8BAAoB;AAC/B,iBAAa,OAAO,OAAP,CAAe,QAAf;AACb,oBAAgB,OAAO,OAAP,CAAe,YAAf;AAChB,iBAAa,OAAO,OAAP,CAAe,WAAf;GAHF,EAKb,UAAS,KAAT,EAAgB,WAAhB,EAA6B,OAA7B,EAAsC,IAAtC,EAA4C;AAC1C,SAAK,YAAL,CAAkB;AAChB,wBAAkB,QAAQ,EAAR;KADpB,EAGG,IAHH,CAGQ,UAAS,IAAT,EAAe;AACnB,UAAI,CAAC,IAAD,EAAO;AACT,eAAO,IAAI,IAAJ,CAAS;AACd,gBAAM,QAAQ,WAAR;AACN,oBAAU,QAAQ,QAAR;AACV,gBAAM,MAAN;AACA,oBAAU,SAAV;AACA,mBAAS,QAAQ,KAAR;SALJ,CAAP,CADS;AAQT,aAAK,SAAL,GACG,IADH,CACQ,UAAS,IAAT,EAAe;AACnB,iBAAO,KAAK,IAAL,EAAW,IAAX,CAAP,CADmB;SAAf,CADR,CAIG,KAJH,CAIS,UAAS,GAAT,EAAc;AACnB,iBAAO,KAAK,GAAL,CAAP,CADmB;SAAd,CAJT,CARS;OAAX,MAeO;AACL,eAAO,KAAK,IAAL,EAAW,IAAX,CAAP,CADK;OAfP;KADI,CAHR,CAuBG,KAvBH,CAuBS,UAAS,GAAT,EAAc;AACnB,aAAO,KAAK,GAAL,CAAP,CADmB;KAAd,CAvBT,CAD0C;GAA5C,CALA,EADqC;CAAvB","file":"auth/twitter/passport.js","sourcesContent":["import passport from 'passport';\nimport {Strategy as TwitterStrategy} from 'passport-twitter';\n\nexports.setup = function(User, config) {\n  passport.use(new TwitterStrategy({\n    consumerKey: config.twitter.clientID,\n    consumerSecret: config.twitter.clientSecret,\n    callbackURL: config.twitter.callbackURL\n  },\n  function(token, tokenSecret, profile, done) {\n    User.findOneAsync({\n      'twitter.id_str': profile.id\n    })\n      .then(function(user) {\n        if (!user) {\n          user = new User({\n            name: profile.displayName,\n            username: profile.username,\n            role: 'user',\n            provider: 'twitter',\n            twitter: profile._json\n          });\n          user.saveAsync()\n            .then(function(user) {\n              return done(null, user);\n            })\n            .catch(function(err) {\n              return done(err);\n            });\n        } else {\n          return done(null, user);\n        }\n      })\n      .catch(function(err) {\n        return done(err);\n      });\n  }));\n};\n"],"sourceRoot":"/source/"}